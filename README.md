# Вавилон : Единый планировщик – TV + Digital (2023)

Сервис предоставляет редакциям платформу для обработки информационных событий, используя материалы друг друга (дополняя друг друга), 
а так же способ совместно прорабатывать список вопросов и тем для обсуждения с одним и тем же спикером.
Система может информирует пользователей обо всех событиях по корпоративной почте: 
о создании нового события; о запросе на присоединение к выполнению задач, связанных с событием; 
о присоединении пользователя к работе с этим событием; о поставленых задачах; 
о наступлении сроков исполнения задач; о результатах выполнения; о подтверждении результатов выполнения задач; 
о новых сообщениях в чате по задаче.

Возможно просматривать списки событий в виде календаря, листа, личных задач.

Возможна фильтрация событий и задач по группам пользователей (редакции, отделы и т.д.)

### Документация API (OpenApi)

Для получения справки по API в браузере требуется набрать адрес:

```
http://<server-address>:<port>/docs
```

### Администрирование

Для доступа к админке требуется войти суперпользователем. 
Имя и логин суперпользователя задаются в файле конфигурации (см. раздел Конфигурация)


### Проверка доступности сервиса

Для проверки доступности серсиса следует запросить страницу:
```
http://<server-address>:<port>/actuator/health
```

### Рассылка автоматических уведомлений

Для рассылки о текущих задачах (просрочка, приближение сроков исполнения) требуется обращатся к странице
```
http://<server-address>:<port>/notifying
```
Вызов этой страницы можно осуществить стандартными средствами ОС (например, через указание задания для системы Cron). 

## Конфигуация
Для задания нижеописанных конфигурационных параметров потребуется 
задать переменные окружения с соответствующими именами,
либо будут использоваться значения по умолчанию.

### Хранилище (Postgres)
**SPRING_DATASOURCE_JDBC_URL** - connection string для БД

Пример значения:
```
jdbc:postgresql://${SQL_HOST:localhost}:5432/default
```

**SPRING_DATASOURCE_USERNAME** - имя пользователя для БД



**SPRING_DATASOURCE_PASSWORD** - пароль пользователя для БД

Пример значения:
```
password
```
**SUPERUSER.LOGIN** - логин суперпользователя

Пример значения:
```
superuser
```
**SUPERUSER.PASSWORD** - пароль суперпользователя

Пример значения:
```
super
```

**MAX-LENGTH-OF-PERIOD** - максимальная длина периода, выводимого на экран в странице События

Пример значения:
```
7
```

**spring.mail.host** - задает адресс хоста почты

Пример значения:
```
email-smtp.us-west-2.amazonaws.com
```

**spring.mail.username** - задает имя пользователя, от имени которого рассылаются уведомления

Пример значения:
```
username
```

**spring.mail.password** - задает пароль для входа

Пример значения:
```
password
```

**spring.mail.properties.mail.transport.protocol=smtp** - указывает протокол для соединения

Пример значения:
```
smtp
```

**spring.mail.properties.mail.smtp.port** - указывает номер порта для соединения

Пример значения:
```
25
```


## Запуск unit-тестов
Находясь в корневой директории проекта выполнить команду
```
./gradlew test
```
Детализированный результат тестов будет сохранен в babylon/build/reports/tests/test/index.html
(в настоящее время не реализованно)

## Создание исполняемого jar-файла
Находясь в корневой директории проекта (redir) выполнить команду
```
./gradlew clean bootJar -Pversion={version}
```
Где {version} - требуемая версия файла, подставить значение.
Либо, с предварительным запуском всех тестов
```
./gradlew clean test bootJar -Pversion={version}
```
В случае успешного выполнения команды в директории ./babylon/build/libs появится исполняемый babylon-impl-{version}.jar

## Запуск исполняемого jar-файла
Запуск осуществляется командой java -jar babylon-{version}.jar
Должен быть установлен **JDK_11**.

